<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cost of Complication: Investment Fee Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F9FAFB; color: #1F2937; }
        h1, h2, h3, .serif { font-family: 'Merriweather', serif; }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 350px; 
            max-height: 400px; 
        }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); }
        .slider-thumb::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; background: #374151; border-radius: 50%; cursor: pointer; }
        .slider-thumb::-moz-range-thumb { width: 20px; height: 20px; background: #374151; border-radius: 50%; cursor: pointer; }
        .active-tab { border-bottom: 2px solid #1F2937; color: #111827; font-weight: 600; }
        .inactive-tab { color: #6B7280; hover:color: #374151; }
    </style>
    <!-- Chosen Palette: "Fiduciary Trust" - Warm Neutrals (Slate/Stone/Gray) with Navy Accents for authority. -->
    <!-- Application Structure Plan: 
         1. Hero Section: Immediate hook on the "1% Problem".
         2. Interactive Simulator (The Core): Users learn best by doing. A calculator clearly showing lost wealth is the most powerful tool.
         3. The Evidence (Tabs): Grouping the requested sources (WSJ, CFA, Siegel, Morningstar) into specific categories (Media, Academic, Industry).
         4. Visualization Dashboard: Two distinct charts (Growth Curve & The 'Lost' Wedge) to visualize the data generated by the simulator.
         5. Key Takeaways: Summary of the research findings.
    -->
    <!-- Visualization & Content Choices: 
         - Calculator: Goal: Personalize the data. -> Interaction: Sliders for investment/time. -> Justification: Abstract percentages are ignored; dollar amounts ($150,000 lost) are felt.
         - Line Chart: Goal: Show divergence over time. -> Method: Chart.js Line. -> Interaction: Updates with slider input.
         - Area Chart: Goal: Highlight the "Opportunity Cost". -> Method: Chart.js Filled Area. -> Interaction: Updates with slider input.
         - Quote Cards: Goal: Authority. -> Method: Styled HTML cards. -> Justification: Text-heavy content needs breathing room and typographic hierarchy.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-stone-50 text-slate-800">

    <!-- Navigation -->
    <nav class="bg-white border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold serif text-slate-900 tracking-tight">Fee<span class="text-slate-500">Analytics</span></span>
                </div>
                <div class="hidden sm:flex items-center space-x-8">
                    <button onclick="scrollToSection('simulator')" class="text-sm font-medium text-slate-600 hover:text-slate-900 transition">Simulator</button>
                    <button onclick="scrollToSection('evidence')" class="text-sm font-medium text-slate-600 hover:text-slate-900 transition">Expert Evidence</button>
                    <button onclick="scrollToSection('analysis')" class="text-sm font-medium text-slate-600 hover:text-slate-900 transition">Visual Analysis</button>
                </div>
                <!-- Mobile Menu Button (Functional via simple logic) -->
                <div class="flex items-center sm:hidden">
                    <button id="mobile-menu-btn" class="text-slate-500 hover:text-slate-700 p-2">
                        <span class="text-xl">‚ò∞</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden sm:hidden bg-white border-b border-stone-200">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button onclick="scrollToSection('simulator')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-700 hover:bg-stone-100 rounded-md">Simulator</button>
                <button onclick="scrollToSection('evidence')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-700 hover:bg-stone-100 rounded-md">Expert Evidence</button>
                <button onclick="scrollToSection('analysis')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-700 hover:bg-stone-100 rounded-md">Visual Analysis</button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-white pt-16 pb-12 sm:pt-24 sm:pb-20 px-4 sm:px-6 lg:px-8 text-center max-w-5xl mx-auto">
        <h1 class="text-4xl sm:text-5xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-6 leading-tight">
            The Tyranny of Compounding Costs
        </h1>
        <p class="text-xl sm:text-2xl text-slate-600 max-w-3xl mx-auto mb-10 leading-relaxed font-light">
            Why a "small" 1% or 2% fee is the single largest threat to your financial future. authoritative analysis from the <span class="font-semibold text-slate-800">CFA Institute</span>, <span class="font-semibold text-slate-800">Wall Street Journal</span>, and leading academics.
        </p>
        <div class="flex flex-col sm:flex-row justify-center gap-4">
            <button onclick="scrollToSection('simulator')" class="bg-slate-900 text-white px-8 py-3 rounded-lg text-lg font-medium hover:bg-slate-800 transition shadow-lg transform hover:-translate-y-0.5">
                Calculate Your Fee Drag
            </button>
            <button onclick="scrollToSection('evidence')" class="bg-white text-slate-700 border border-slate-300 px-8 py-3 rounded-lg text-lg font-medium hover:bg-stone-50 transition shadow-sm">
                View the Research
            </button>
        </div>
    </header>

    <!-- Context Bar -->
    <section class="bg-stone-100 border-y border-stone-200 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div>
                <div class="text-3xl font-bold text-slate-900 mb-1">100%</div>
                <div class="text-sm font-medium text-slate-500 uppercase tracking-wide">Risk Taken by You</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-slate-900 mb-1">100%</div>
                <div class="text-sm font-medium text-slate-500 uppercase tracking-wide">Capital Provided by You</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-slate-900 mb-1 text-red-700">30%+</div>
                <div class="text-sm font-medium text-slate-500 uppercase tracking-wide">Profits Lost to High Fees*</div>
            </div>
        </div>
        <div class="text-center mt-4 text-xs text-stone-500">*Over a 30-year period with 2% fees and 7% gross return.</div>
    </section>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24">

        <!-- SECTION 1: Interactive Simulator -->
        <section id="simulator" class="scroll-mt-24">
            <div class="max-w-3xl mx-auto text-center mb-10">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">The Fee Drag Simulator</h2>
                <p class="text-lg text-slate-600">
                    Use this interactive tool to visualize how fees erode compound interest. Adjust the sliders to see the impact on your ending portfolio balance. Notice how the gap widens significantly over time.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Controls -->
                <div class="lg:col-span-4 bg-white p-6 rounded-xl border border-stone-200 shadow-sm h-fit">
                    <h3 class="text-lg font-bold text-slate-900 mb-6 border-b pb-2">Input Assumptions</h3>
                    
                    <div class="space-y-6">
                        <!-- Initial Investment -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium text-slate-700">Initial Investment</label>
                                <span class="text-sm font-bold text-slate-900" id="display-investment">$100,000</span>
                            </div>
                            <input type="range" min="10000" max="1000000" step="5000" value="100000" id="input-investment" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer slider-thumb">
                        </div>

                        <!-- Years to Grow -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium text-slate-700">Time Horizon (Years)</label>
                                <span class="text-sm font-bold text-slate-900" id="display-years">30 Years</span>
                            </div>
                            <input type="range" min="5" max="50" step="1" value="30" id="input-years" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer slider-thumb">
                        </div>

                        <!-- Expected Gross Return -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium text-slate-700">Gross Annual Return</label>
                                <span class="text-sm font-bold text-slate-900" id="display-return">7.0%</span>
                            </div>
                            <input type="range" min="3" max="12" step="0.1" value="7.0" id="input-return" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer slider-thumb">
                            <p class="text-xs text-stone-500 mt-1">Historical equity average approx. 7-10%</p>
                        </div>

                        <!-- High Fee Scenario -->
                        <div class="pt-4 border-t border-stone-100">
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium text-slate-700">High Fee Fund Cost</label>
                                <span class="text-sm font-bold text-red-600" id="display-fee">2.00%</span>
                            </div>
                            <input type="range" min="0.5" max="3.0" step="0.05" value="2.00" id="input-fee" class="w-full h-2 bg-red-100 rounded-lg appearance-none cursor-pointer slider-thumb accent-red-600">
                            <p class="text-xs text-stone-500 mt-1">Typical active fund + advisor fee range.</p>
                        </div>
                    </div>

                    <!-- Summary Results Card -->
                    <div class="mt-8 bg-stone-50 rounded-lg p-4 border border-stone-200">
                        <div class="text-xs font-semibold text-stone-500 uppercase mb-1">Total Lost to Fees</div>
                        <div class="text-3xl font-extrabold text-red-600" id="result-lost-wealth">$0</div>
                        <div class="text-xs text-stone-500 mt-2">
                            This is money that went to fees and the <em>growth that money would have earned</em>.
                        </div>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="lg:col-span-8 bg-white p-6 rounded-xl border border-stone-200 shadow-sm flex flex-col">
                    <div class="mb-4 flex justify-between items-end">
                        <h3 class="text-lg font-bold text-slate-900">Wealth Trajectory Analysis</h3>
                        <div class="flex gap-4 text-xs">
                            <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-slate-800 mr-2"></span>Low Fee (0.1%)</div>
                            <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-red-500 mr-2"></span>High Fee (<span id="legend-high-fee">2.0%</span>)</div>
                        </div>
                    </div>
                    
                    <div class="chart-container flex-grow">
                        <canvas id="growthChart"></canvas>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="p-3 bg-slate-50 rounded border border-slate-100">
                            <div class="text-xs text-slate-500">Low Fee Ending Balance</div>
                            <div class="text-lg font-bold text-slate-900" id="val-low-fee">$0</div>
                        </div>
                        <div class="p-3 bg-red-50 rounded border border-red-100">
                            <div class="text-xs text-red-600">High Fee Ending Balance</div>
                            <div class="text-lg font-bold text-red-700" id="val-high-fee">$0</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: Expert Evidence -->
        <section id="evidence" class="scroll-mt-24">
            <div class="mb-10 text-center max-w-3xl mx-auto">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">Authoritative Perspectives</h2>
                <p class="text-lg text-slate-600">
                    Leading financial institutions, academic journals, and market commentators agree: minimizing costs is one of the few reliable ways to improve investment outcomes.
                </p>
            </div>

            <!-- Tab Navigation -->
            <div class="flex justify-center mb-8 border-b border-stone-200">
                <button onclick="switchTab('academic')" id="tab-academic" class="active-tab px-6 py-3 text-sm font-medium transition focus:outline-none">Academic & Research</button>
                <button onclick="switchTab('media')" id="tab-media" class="inactive-tab px-6 py-3 text-sm font-medium transition focus:outline-none">Financial Media</button>
                <button onclick="switchTab('industry')" id="tab-industry" class="inactive-tab px-6 py-3 text-sm font-medium transition focus:outline-none">Industry Analysis</button>
            </div>

            <!-- Tab Content: Academic -->
            <div id="content-academic" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">üéì</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Professor Jeremy Siegel</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Wharton School of Business</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "In the long run, it is the net return‚Äîthe gross return minus inflation and transaction costs‚Äîthat determines the wealth of the investor."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> In <em>Stocks for the Long Run</em>, Siegel emphasizes that while you cannot control market returns, failing to control costs (fees) ensures a subpar net return.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">üìä</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">CFA Institute</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Financial Analysts Journal</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "Investment costs are a direct deduction from investment returns... All else being equal, lower costs lead to higher returns."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> The global association for investment professionals consistently teaches that fee reduction is a primary fiduciary duty because it is the most certain way to improve client outcomes.
                    </p>
                </div>
            </div>

            <!-- Tab Content: Media (Hidden by default) -->
            <div id="content-media" class="hidden grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">üì∞</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Wall Street Journal</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Jason Zweig / Intelligent Investor</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "Fees are one of the few things in investing that are entirely within your control. Every dollar you don't pay in fees is a dollar that stays in your account to compound."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> The WSJ repeatedly highlights that while chasing performance is often futile, cutting costs is a guaranteed mathematical win.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">üèõÔ∏è</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">SEC.gov</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Office of Investor Education</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "High fees and expenses do not guarantee better performance... Even small differences in fees can translate into large differences in returns over time."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> The U.S. Securities and Exchange Commission explicitly warns investors that high costs are a major drag on portfolio health.
                    </p>
                </div>
            </div>

            <!-- Tab Content: Industry (Hidden by default) -->
            <div id="content-industry" class="hidden grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">‚≠ê</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Morningstar</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Russel Kinnel, Director of Research</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "If there's one thing we know for certain, it's that fees are the best predictor of future performance. Low-cost funds have a higher probability of outperforming."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> Their famous "Mind the Gap" studies consistently show that the cheapest quintile of funds outperforms the most expensive quintile across almost all asset classes.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl border border-stone-200 shadow-sm hover:shadow-md transition">
                    <div class="h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-2xl">üìâ</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Kenneth French</h3>
                    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-4">Dartmouth College</div>
                    <blockquote class="text-slate-600 italic mb-4">
                        "The aggregate portfolio of active investors must return the market minus fees. The aggregate portfolio of passive investors returns the market minus much smaller fees."
                    </blockquote>
                    <p class="text-sm text-slate-500 border-t border-stone-100 pt-4">
                        <strong>Insight:</strong> This is the "Arithmetic of Active Management." It is a mathematical certainty that the average active investor <em>must</em> underperform the market by the amount of the fees they pay.
                    </p>
                </div>
            </div>
        </section>

        <!-- SECTION 3: Visual Analysis (Deep Dive) -->
        <section id="analysis" class="scroll-mt-24 bg-slate-900 rounded-2xl p-8 sm:p-12 text-white">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl font-bold text-white mb-6">The "Fee Wedge" Effect</h2>
                    <p class="text-slate-300 text-lg mb-6">
                        The chart to the right illustrates the "Wedge." It is the invisible money that vanishes from your account. 
                    </p>
                    <ul class="space-y-4 mb-8">
                        <li class="flex items-start">
                            <span class="bg-red-500 rounded-full w-2 h-2 mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong class="text-white block">Compounding works both ways</strong>
                                <span class="text-slate-400 text-sm">You pay fees on your principal, but you also lose the growth that the fee money would have earned had it stayed invested.</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="bg-red-500 rounded-full w-2 h-2 mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong class="text-white block">The 2% Fallacy</strong>
                                <span class="text-slate-400 text-sm">A 2% fee doesn't reduce your ending wealth by 2%. Over 30 years, a 2% annual fee can consume over <strong>40% of your total potential returns</strong>.</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="bg-red-500 rounded-full w-2 h-2 mt-2 mr-3 flex-shrink-0"></span>
                            <div>
                                <strong class="text-white block">Zero Risk, guaranteed loss</strong>
                                <span class="text-slate-400 text-sm">Fees are the only aspect of investing where you pay 100% of the cost regardless of whether the fund performs well or poorly.</span>
                            </div>
                        </li>
                    </ul>
                    <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                        <div class="text-sm text-slate-400 mb-1">Key Insight from Research</div>
                        <div class="text-white italic">"Expense ratios are the most reliable predictor of future performance." ‚Äî Morningstar</div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-4 text-slate-900">
                    <h3 class="text-center font-bold mb-2">Percentage of Total Gains Consumed by Fees</h3>
                    <div class="chart-container">
                        <canvas id="impactChart"></canvas>
                    </div>
                    <div class="text-center text-xs text-slate-500 mt-2">
                        Impact of different fee levels over a 30-year horizon (7% Gross Return)
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center text-slate-500 text-sm pt-8 border-t border-stone-200">
            <p>¬© 2024 Fee Analysis Dashboard. For educational purposes only.</p>
            <p class="mt-2">Based on principles sourced from WSJ, CFA Institute, and Academic Research.</p>
        </footer>

    </main>

    <script>
        // --- State Management ---
        const state = {
            investment: 100000,
            years: 30,
            returnRate: 7.0,
            highFee: 2.0,
            lowFee: 0.1 // Benchmark low fee ETF
        };

        // --- DOM Elements ---
        const inputs = {
            investment: document.getElementById('input-investment'),
            years: document.getElementById('input-years'),
            returnRate: document.getElementById('input-return'),
            fee: document.getElementById('input-fee')
        };

        const displays = {
            investment: document.getElementById('display-investment'),
            years: document.getElementById('display-years'),
            returnRate: document.getElementById('display-return'),
            fee: document.getElementById('display-fee'),
            legendHighFee: document.getElementById('legend-high-fee'),
            lostWealth: document.getElementById('result-lost-wealth'),
            valLow: document.getElementById('val-low-fee'),
            valHigh: document.getElementById('val-high-fee')
        };

        // --- Chart Instances ---
        let growthChart = null;
        let impactChart = null;

        // --- Formatters ---
        const formatCurrency = (num) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(num);

        // --- Core Calculation Logic ---
        function calculateGrowth() {
            const dataLow = [];
            const dataHigh = [];
            const labels = [];
            
            let currentLow = state.investment;
            let currentHigh = state.investment;
            
            // Adjust return rates for fees
            const rateLow = (state.returnRate - state.lowFee) / 100;
            const rateHigh = (state.returnRate - state.highFee) / 100;

            for (let i = 0; i <= state.years; i++) {
                labels.push(`Year ${i}`);
                dataLow.push(currentLow);
                dataHigh.push(currentHigh);

                // Compound for next year
                currentLow = currentLow * (1 + rateLow);
                currentHigh = currentHigh * (1 + rateHigh);
            }

            return { labels, dataLow, dataHigh, finalLow: currentLow, finalHigh: currentHigh };
        }

        // --- Visualization Updates ---
        function updateCharts(data) {
            // Update Growth Chart (Line)
            if (growthChart) {
                growthChart.data.labels = data.labels;
                growthChart.data.datasets[0].data = data.dataLow;
                growthChart.data.datasets[1].data = data.dataHigh;
                growthChart.data.datasets[1].label = `High Fee Portfolio (${state.highFee}%)`;
                growthChart.update();
            }

            // Update Impact Chart (Pie/Doughnut for context in the Deep Dive section)
            // Calculating the "Lost" portion relative to the potential Gain
            const totalGain = data.finalLow - state.investment;
            const lostToFees = data.finalLow - data.finalHigh;
            const keptGain = totalGain - lostToFees;
            
            if (impactChart) {
                impactChart.data.datasets[0].data = [keptGain, lostToFees];
                impactChart.update();
            }
        }

        function updateUI() {
            // Read inputs
            state.investment = parseFloat(inputs.investment.value);
            state.years = parseInt(inputs.years.value);
            state.returnRate = parseFloat(inputs.returnRate.value);
            state.highFee = parseFloat(inputs.fee.value);

            // Update Display Text
            displays.investment.textContent = formatCurrency(state.investment);
            displays.years.textContent = `${state.years} Years`;
            displays.returnRate.textContent = `${state.returnRate}%`;
            displays.fee.textContent = `${state.highFee}%`;
            displays.legendHighFee.textContent = `${state.highFee}%`;

            // Calculate
            const results = calculateGrowth();
            const lostWealth = results.finalLow - results.finalHigh;

            // Update Results Text
            displays.lostWealth.textContent = formatCurrency(lostWealth);
            displays.valLow.textContent = formatCurrency(results.finalLow);
            displays.valHigh.textContent = formatCurrency(results.finalHigh);

            // Update Visuals
            updateCharts(results);
        }

        // --- Initialization ---
        function initCharts() {
            // 1. Growth Chart
            const ctxGrowth = document.getElementById('growthChart').getContext('2d');
            growthChart = new Chart(ctxGrowth, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'Low Fee Portfolio (0.1%)',
                            data: [],
                            borderColor: '#1F2937', // Slate 800
                            backgroundColor: 'rgba(31, 41, 55, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'High Fee Portfolio',
                            data: [],
                            borderColor: '#EF4444', // Red 500
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            borderDash: [5, 5],
                            tension: 0.4,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatCurrency(context.raw);
                                }
                            }
                        },
                        legend: { position: 'bottom' }
                    },
                    scales: {
                        y: {
                            ticks: { callback: (value) => '$' + value.toLocaleString() },
                            grid: { color: '#F3F4F6' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { maxTicksLimit: 6 }
                        }
                    }
                }
            });

            // 2. Impact Chart (Doughnut)
            const ctxImpact = document.getElementById('impactChart').getContext('2d');
            impactChart = new Chart(ctxImpact, {
                type: 'doughnut',
                data: {
                    labels: ['Gains Kept', 'Gains Lost to Fees'],
                    datasets: [{
                        data: [],
                        backgroundColor: ['#1F2937', '#EF4444'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.chart._metasets[context.datasetIndex].total;
                                    const percentage = ((value / total) * 100).toFixed(1) + '%';
                                    return context.label + ': ' + percentage + ' (' + formatCurrency(value) + ')';
                                }
                            }
                        }
                    }
                }
            });

            updateUI();
        }

        // --- Navigation Logic ---
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
                // Close mobile menu if open
                document.getElementById('mobile-menu').classList.add('hidden');
            }
        }

        function switchTab(tabId) {
            // Hide all contents
            ['academic', 'media', 'industry'].forEach(id => {
                document.getElementById(`content-${id}`).classList.add('hidden');
                document.getElementById(`tab-${id}`).classList.remove('active-tab');
                document.getElementById(`tab-${id}`).classList.add('inactive-tab');
            });

            // Show selected content
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
            document.getElementById(`tab-${tabId}`).classList.add('active-tab');
            document.getElementById(`tab-${tabId}`).classList.remove('inactive-tab');
        }

        // --- Event Listeners ---
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', updateUI);
        });

        // Mobile Menu Toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // Start
        document.addEventListener('DOMContentLoaded', initCharts);

    </script>
</body>
</html>